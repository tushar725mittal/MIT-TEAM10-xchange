import unittest

from backend import (
    init_db,
    get_creds,
    get_data_for_date,
    get_value_in_date_range,
    get_wmqy_data,
)

import datetime

# set maxDiff to None to see the full diff
unittest.TestCase.maxDiff = None


class TestBackend(unittest.TestCase):
    def setUp(self):

        self.db = init_db(*get_creds())

    def test_get_data_for_date(self):
        data = get_data_for_date(self.db, "2020-5-12", "USD", "EUR")
        self.assertEqual(data, 0.920979923)

    def test_get_value_in_date_range(self):
        data = get_value_in_date_range(
            self.db, "2020-01-12", "2020-01-19", "USD", "EUR"
        )
        self.assertEqual(
            data,
            [
                {"date": datetime.datetime(2020, 1, 13, 0, 0), "value": 0.898795614},
                {"date": datetime.datetime(2020, 1, 14, 0, 0), "value": 0.89968511},
                {"date": datetime.datetime(2020, 1, 15, 0, 0), "value": 0.897504936},
                {"date": datetime.datetime(2020, 1, 16, 0, 0), "value": 0.895335303},
                {"date": datetime.datetime(2020, 1, 17, 0, 0), "value": 0.900252071},
            ],
        )

    def test_get_wmqy_data(self):
        data = get_wmqy_data(self.db, "w", "INR", "USD", "2021-03-05")
        self.assertEqual(
            data,
            [
                {"date": datetime.datetime(2021, 2, 26, 0, 0), "value": 73.0408},
                {"date": datetime.datetime(2021, 3, 1, 0, 0), "value": 73.2948},
                {"date": datetime.datetime(2021, 3, 2, 0, 0), "value": 73.3507},
                {"date": datetime.datetime(2021, 3, 3, 0, 0), "value": 73.0662},
                {"date": datetime.datetime(2021, 3, 4, 0, 0), "value": 72.7126},
                {"date": datetime.datetime(2021, 3, 5, 0, 0), "value": 72.7572},
            ],
        )

        data = get_wmqy_data(self.db, "m", "INR", "USD", "2021-03-05")
        self.assertEqual(
            data,
            [
                {"date": datetime.datetime(2021, 2, 3, 0, 0), "value": 72.9396},
                {"date": datetime.datetime(2021, 2, 4, 0, 0), "value": 72.9152},
                {"date": datetime.datetime(2021, 2, 5, 0, 0), "value": 72.8986},
                {"date": datetime.datetime(2021, 2, 8, 0, 0), "value": 72.8623},
                {"date": datetime.datetime(2021, 2, 9, 0, 0), "value": 72.8883},
                {"date": datetime.datetime(2021, 2, 10, 0, 0), "value": 72.8458},
                {"date": datetime.datetime(2021, 2, 11, 0, 0), "value": 72.7772},
                {"date": datetime.datetime(2021, 2, 12, 0, 0), "value": 72.7998},
                {"date": datetime.datetime(2021, 2, 16, 0, 0), "value": 72.7219},
                {"date": datetime.datetime(2021, 2, 17, 0, 0), "value": 72.8359},
                {"date": datetime.datetime(2021, 2, 18, 0, 0), "value": 72.7327},
                {
                    "date": datetime.datetime(2021, 2, 19, 0, 0),
                    "value": 73.65705081194677,
                },
                {"date": datetime.datetime(2021, 2, 22, 0, 0), "value": 72.3664},
                {"date": datetime.datetime(2021, 2, 23, 0, 0), "value": 72.3707},
                {"date": datetime.datetime(2021, 2, 24, 0, 0), "value": 72.2923},
                {"date": datetime.datetime(2021, 2, 25, 0, 0), "value": 72.4953},
                {"date": datetime.datetime(2021, 2, 26, 0, 0), "value": 73.0408},
                {"date": datetime.datetime(2021, 3, 1, 0, 0), "value": 73.2948},
                {"date": datetime.datetime(2021, 3, 2, 0, 0), "value": 73.3507},
                {"date": datetime.datetime(2021, 3, 3, 0, 0), "value": 73.0662},
                {"date": datetime.datetime(2021, 3, 4, 0, 0), "value": 72.7126},
                {"date": datetime.datetime(2021, 3, 5, 0, 0), "value": 72.7572},
            ],
        )

        data = get_wmqy_data(self.db, "q", "INR", "USD", "2021-03-05")
        self.assertEqual(
            data,
            [
                {"date": datetime.datetime(2020, 12, 7, 0, 0), "value": 73.7657},
                {"date": datetime.datetime(2020, 12, 8, 0, 0), "value": 73.7613},
                {"date": datetime.datetime(2020, 12, 9, 0, 0), "value": 73.5882},
                {"date": datetime.datetime(2020, 12, 10, 0, 0), "value": 73.6684},
                {"date": datetime.datetime(2020, 12, 11, 0, 0), "value": 73.5914},
                {"date": datetime.datetime(2020, 12, 14, 0, 0), "value": 73.5417},
                {"date": datetime.datetime(2020, 12, 15, 0, 0), "value": 73.6532},
                {"date": datetime.datetime(2020, 12, 16, 0, 0), "value": 73.5209},
                {"date": datetime.datetime(2020, 12, 17, 0, 0), "value": 73.4336},
                {"date": datetime.datetime(2020, 12, 18, 0, 0), "value": 73.5146},
                {"date": datetime.datetime(2020, 12, 21, 0, 0), "value": 73.6498},
                {"date": datetime.datetime(2020, 12, 22, 0, 0), "value": 73.8879},
                {"date": datetime.datetime(2020, 12, 23, 0, 0), "value": 73.8132},
                {"date": datetime.datetime(2021, 1, 4, 0, 0), "value": 73.0115},
                {"date": datetime.datetime(2021, 1, 5, 0, 0), "value": 73.1086},
                {"date": datetime.datetime(2021, 1, 6, 0, 0), "value": 73.139},
                {"date": datetime.datetime(2021, 1, 7, 0, 0), "value": 73.133},
                {"date": datetime.datetime(2021, 1, 8, 0, 0), "value": 73.3344},
                {"date": datetime.datetime(2021, 1, 11, 0, 0), "value": 73.4511},
                {"date": datetime.datetime(2021, 1, 12, 0, 0), "value": 73.3725},
                {"date": datetime.datetime(2021, 1, 13, 0, 0), "value": 73.1546},
                {"date": datetime.datetime(2021, 1, 14, 0, 0), "value": 73.1226},
                {"date": datetime.datetime(2021, 1, 15, 0, 0), "value": 73.0243},
                {"date": datetime.datetime(2021, 1, 19, 0, 0), "value": 73.1803},
                {"date": datetime.datetime(2021, 1, 20, 0, 0), "value": 73.1251},
                {"date": datetime.datetime(2021, 1, 21, 0, 0), "value": 72.9735},
                {"date": datetime.datetime(2021, 1, 22, 0, 0), "value": 73.038},
                {"date": datetime.datetime(2021, 1, 25, 0, 0), "value": 72.9297},
                {
                    "date": datetime.datetime(2021, 1, 26, 0, 0),
                    "value": 73.79583369571826,
                },
                {"date": datetime.datetime(2021, 1, 27, 0, 0), "value": 72.8176},
                {"date": datetime.datetime(2021, 1, 28, 0, 0), "value": 73.0674},
                {"date": datetime.datetime(2021, 1, 29, 0, 0), "value": 72.9519},
                {"date": datetime.datetime(2021, 2, 1, 0, 0), "value": 73.0189},
                {"date": datetime.datetime(2021, 2, 2, 0, 0), "value": 72.9805},
                {"date": datetime.datetime(2021, 2, 3, 0, 0), "value": 72.9396},
                {"date": datetime.datetime(2021, 2, 4, 0, 0), "value": 72.9152},
                {"date": datetime.datetime(2021, 2, 5, 0, 0), "value": 72.8986},
                {"date": datetime.datetime(2021, 2, 8, 0, 0), "value": 72.8623},
                {"date": datetime.datetime(2021, 2, 9, 0, 0), "value": 72.8883},
                {"date": datetime.datetime(2021, 2, 10, 0, 0), "value": 72.8458},
                {"date": datetime.datetime(2021, 2, 11, 0, 0), "value": 72.7772},
                {"date": datetime.datetime(2021, 2, 12, 0, 0), "value": 72.7998},
                {"date": datetime.datetime(2021, 2, 16, 0, 0), "value": 72.7219},
                {"date": datetime.datetime(2021, 2, 17, 0, 0), "value": 72.8359},
                {"date": datetime.datetime(2021, 2, 18, 0, 0), "value": 72.7327},
                {
                    "date": datetime.datetime(2021, 2, 19, 0, 0),
                    "value": 73.65705081194677,
                },
                {"date": datetime.datetime(2021, 2, 22, 0, 0), "value": 72.3664},
                {"date": datetime.datetime(2021, 2, 23, 0, 0), "value": 72.3707},
                {"date": datetime.datetime(2021, 2, 24, 0, 0), "value": 72.2923},
                {"date": datetime.datetime(2021, 2, 25, 0, 0), "value": 72.4953},
                {"date": datetime.datetime(2021, 2, 26, 0, 0), "value": 73.0408},
                {"date": datetime.datetime(2021, 3, 1, 0, 0), "value": 73.2948},
                {"date": datetime.datetime(2021, 3, 2, 0, 0), "value": 73.3507},
                {"date": datetime.datetime(2021, 3, 3, 0, 0), "value": 73.0662},
                {"date": datetime.datetime(2021, 3, 4, 0, 0), "value": 72.7126},
                {"date": datetime.datetime(2021, 3, 5, 0, 0), "value": 72.7572},
            ],
        )

        data = get_wmqy_data(self.db, "y", "INR", "USD", "2021-03-05")
        self.assertEqual(
            data,
            [
                {"date": datetime.datetime(2020, 3, 5, 0, 0), "value": 73.2824},
                {"date": datetime.datetime(2020, 3, 6, 0, 0), "value": 73.6629},
                {"date": datetime.datetime(2020, 3, 9, 0, 0), "value": 73.9538},
                {
                    "date": datetime.datetime(2020, 3, 10, 0, 0),
                    "value": 73.66935689518742,
                },
                {"date": datetime.datetime(2020, 3, 11, 0, 0), "value": 73.8128},
                {"date": datetime.datetime(2020, 3, 12, 0, 0), "value": 74.1694},
                {"date": datetime.datetime(2020, 3, 13, 0, 0), "value": 74.0694},
                {"date": datetime.datetime(2020, 3, 16, 0, 0), "value": 74.2723},
                {"date": datetime.datetime(2020, 3, 17, 0, 0), "value": 74.0309},
                {"date": datetime.datetime(2020, 3, 18, 0, 0), "value": 74.1727},
                {"date": datetime.datetime(2020, 3, 19, 0, 0), "value": 75.0583},
                {
                    "date": datetime.datetime(2020, 3, 20, 0, 0),
                    "value": 73.79034160409473,
                },
                {"date": datetime.datetime(2020, 3, 23, 0, 0), "value": 75.8814},
                {"date": datetime.datetime(2020, 3, 24, 0, 0), "value": 76.1522},
                {
                    "date": datetime.datetime(2020, 3, 25, 0, 0),
                    "value": 73.84758122295449,
                },
                {"date": datetime.datetime(2020, 3, 26, 0, 0), "value": 75.2392},
                {"date": datetime.datetime(2020, 3, 27, 0, 0), "value": 74.8434},
                {"date": datetime.datetime(2020, 3, 30, 0, 0), "value": 75.3451},
                {"date": datetime.datetime(2020, 3, 31, 0, 0), "value": 75.3859},
                {"date": datetime.datetime(2020, 4, 1, 0, 0), "value": 75.3859},
                {
                    "date": datetime.datetime(2020, 4, 2, 0, 0),
                    "value": 73.9346680477037,
                },
                {"date": datetime.datetime(2020, 4, 3, 0, 0), "value": 75.8276},
                {
                    "date": datetime.datetime(2020, 4, 6, 0, 0),
                    "value": 73.9761408621521,
                },
                {"date": datetime.datetime(2020, 4, 7, 0, 0), "value": 75.8438},
                {"date": datetime.datetime(2020, 4, 8, 0, 0), "value": 76.0867},
                {"date": datetime.datetime(2020, 4, 9, 0, 0), "value": 76.4577},
                {
                    "date": datetime.datetime(2020, 4, 10, 0, 0),
                    "value": 74.01623625207745,
                },
                {"date": datetime.datetime(2020, 4, 13, 0, 0), "value": 76.3617},
                {
                    "date": datetime.datetime(2020, 4, 14, 0, 0),
                    "value": 74.05495644805048,
                },
                {"date": datetime.datetime(2020, 4, 15, 0, 0), "value": 76.2743},
                {"date": datetime.datetime(2020, 4, 16, 0, 0), "value": 76.7408},
                {"date": datetime.datetime(2020, 4, 17, 0, 0), "value": 76.5444},
                {"date": datetime.datetime(2020, 4, 20, 0, 0), "value": 76.6335},
                {"date": datetime.datetime(2020, 4, 21, 0, 0), "value": 76.6516},
                {"date": datetime.datetime(2020, 4, 22, 0, 0), "value": 76.8084},
                {"date": datetime.datetime(2020, 4, 23, 0, 0), "value": 76.0635},
                {"date": datetime.datetime(2020, 4, 24, 0, 0), "value": 76.4173},
                {"date": datetime.datetime(2020, 4, 27, 0, 0), "value": 76.1269},
                {"date": datetime.datetime(2020, 4, 28, 0, 0), "value": 76.371},
                {"date": datetime.datetime(2020, 4, 29, 0, 0), "value": 75.6961},
                {"date": datetime.datetime(2020, 4, 30, 0, 0), "value": 75.115},
                {
                    "date": datetime.datetime(2020, 5, 1, 0, 0),
                    "value": 74.2042271167499,
                },
                {"date": datetime.datetime(2020, 5, 4, 0, 0), "value": 75.7902},
                {"date": datetime.datetime(2020, 5, 5, 0, 0), "value": 75.5715},
                {"date": datetime.datetime(2020, 5, 6, 0, 0), "value": 75.6911},
                {
                    "date": datetime.datetime(2020, 5, 7, 0, 0),
                    "value": 74.25102204204542,
                },
                {"date": datetime.datetime(2020, 5, 8, 0, 0), "value": 75.4411},
                {"date": datetime.datetime(2020, 5, 11, 0, 0), "value": 75.6838},
                {"date": datetime.datetime(2020, 5, 12, 0, 0), "value": 75.7944},
                {"date": datetime.datetime(2020, 5, 13, 0, 0), "value": 75.3885},
                {"date": datetime.datetime(2020, 5, 14, 0, 0), "value": 75.444},
                {"date": datetime.datetime(2020, 5, 15, 0, 0), "value": 75.5634},
                {"date": datetime.datetime(2020, 5, 18, 0, 0), "value": 75.9345},
                {"date": datetime.datetime(2020, 5, 19, 0, 0), "value": 75.6638},
                {"date": datetime.datetime(2020, 5, 20, 0, 0), "value": 75.6712},
                {"date": datetime.datetime(2020, 5, 21, 0, 0), "value": 75.7785},
                {"date": datetime.datetime(2020, 5, 22, 0, 0), "value": 75.7868},
                {"date": datetime.datetime(2020, 5, 26, 0, 0), "value": 75.6404},
                {"date": datetime.datetime(2020, 5, 27, 0, 0), "value": 75.6476},
                {"date": datetime.datetime(2020, 5, 28, 0, 0), "value": 75.7501},
                {"date": datetime.datetime(2020, 5, 29, 0, 0), "value": 75.6369},
                {"date": datetime.datetime(2020, 6, 1, 0, 0), "value": 75.4792},
                {"date": datetime.datetime(2020, 6, 2, 0, 0), "value": 75.5871},
                {"date": datetime.datetime(2020, 6, 3, 0, 0), "value": 75.326},
                {"date": datetime.datetime(2020, 6, 4, 0, 0), "value": 75.529},
                {"date": datetime.datetime(2020, 6, 5, 0, 0), "value": 75.4665},
                {"date": datetime.datetime(2020, 6, 8, 0, 0), "value": 75.6307},
                {"date": datetime.datetime(2020, 6, 9, 0, 0), "value": 75.4931},
                {"date": datetime.datetime(2020, 6, 10, 0, 0), "value": 75.4688},
                {"date": datetime.datetime(2020, 6, 11, 0, 0), "value": 75.7907},
                {"date": datetime.datetime(2020, 6, 12, 0, 0), "value": 75.973},
                {"date": datetime.datetime(2020, 6, 15, 0, 0), "value": 76.1056},
                {"date": datetime.datetime(2020, 6, 16, 0, 0), "value": 75.841},
                {"date": datetime.datetime(2020, 6, 17, 0, 0), "value": 76.2032},
                {"date": datetime.datetime(2020, 6, 18, 0, 0), "value": 76.1509},
                {"date": datetime.datetime(2020, 6, 19, 0, 0), "value": 76.2144},
                {
                    "date": datetime.datetime(2020, 6, 22, 0, 0),
                    "value": 74.50866863430062,
                },
                {
                    "date": datetime.datetime(2020, 6, 23, 0, 0),
                    "value": 74.51229733524545,
                },
                {"date": datetime.datetime(2020, 6, 24, 0, 0), "value": 75.7087},
                {"date": datetime.datetime(2020, 6, 25, 0, 0), "value": 75.6349},
                {"date": datetime.datetime(2020, 6, 26, 0, 0), "value": 75.4757},
                {"date": datetime.datetime(2020, 6, 29, 0, 0), "value": 75.568},
                {"date": datetime.datetime(2020, 6, 30, 0, 0), "value": 75.527},
                {"date": datetime.datetime(2020, 7, 1, 0, 0), "value": 75.5813},
                {"date": datetime.datetime(2020, 7, 2, 0, 0), "value": 75.4876},
                {"date": datetime.datetime(2020, 7, 7, 0, 0), "value": 74.8609},
                {"date": datetime.datetime(2020, 7, 8, 0, 0), "value": 75.027},
                {"date": datetime.datetime(2020, 7, 9, 0, 0), "value": 75.0031},
                {"date": datetime.datetime(2020, 7, 10, 0, 0), "value": 75.2865},
                {"date": datetime.datetime(2020, 7, 13, 0, 0), "value": 75.1567},
                {"date": datetime.datetime(2020, 7, 14, 0, 0), "value": 75.3935},
                {"date": datetime.datetime(2020, 7, 15, 0, 0), "value": 75.3123},
                {"date": datetime.datetime(2020, 7, 16, 0, 0), "value": 75.242},
                {"date": datetime.datetime(2020, 7, 17, 0, 0), "value": 75.1015},
                {"date": datetime.datetime(2020, 7, 20, 0, 0), "value": 74.9666},
                {"date": datetime.datetime(2020, 7, 21, 0, 0), "value": 74.7678},
                {"date": datetime.datetime(2020, 7, 22, 0, 0), "value": 74.6848},
                {"date": datetime.datetime(2020, 7, 23, 0, 0), "value": 74.7548},
                {"date": datetime.datetime(2020, 7, 24, 0, 0), "value": 74.8672},
                {"date": datetime.datetime(2020, 7, 27, 0, 0), "value": 74.762},
                {"date": datetime.datetime(2020, 7, 28, 0, 0), "value": 74.7458},
                {"date": datetime.datetime(2020, 7, 29, 0, 0), "value": 74.7667},
                {"date": datetime.datetime(2020, 7, 30, 0, 0), "value": 74.8412},
                {"date": datetime.datetime(2020, 7, 31, 0, 0), "value": 74.7722},
                {"date": datetime.datetime(2020, 8, 3, 0, 0), "value": 74.9789},
                {"date": datetime.datetime(2020, 8, 4, 0, 0), "value": 75.0894},
                {"date": datetime.datetime(2020, 8, 5, 0, 0), "value": 74.9086},
                {"date": datetime.datetime(2020, 8, 6, 0, 0), "value": 74.8591},
                {"date": datetime.datetime(2020, 8, 7, 0, 0), "value": 74.9556},
                {"date": datetime.datetime(2020, 8, 10, 0, 0), "value": 74.878},
                {"date": datetime.datetime(2020, 8, 11, 0, 0), "value": 74.8436},
                {"date": datetime.datetime(2020, 8, 12, 0, 0), "value": 74.8286},
                {"date": datetime.datetime(2020, 8, 13, 0, 0), "value": 74.8369},
                {"date": datetime.datetime(2020, 8, 14, 0, 0), "value": 74.7721},
                {"date": datetime.datetime(2020, 8, 17, 0, 0), "value": 74.8464},
                {"date": datetime.datetime(2020, 8, 18, 0, 0), "value": 74.819},
                {"date": datetime.datetime(2020, 8, 19, 0, 0), "value": 74.7608},
                {"date": datetime.datetime(2020, 8, 20, 0, 0), "value": 75.0062},
                {"date": datetime.datetime(2020, 8, 21, 0, 0), "value": 74.8755},
                {"date": datetime.datetime(2020, 8, 24, 0, 0), "value": 74.8282},
                {"date": datetime.datetime(2020, 8, 25, 0, 0), "value": 74.3952},
                {"date": datetime.datetime(2020, 8, 26, 0, 0), "value": 74.3541},
                {"date": datetime.datetime(2020, 8, 27, 0, 0), "value": 74.3263},
                {"date": datetime.datetime(2020, 8, 28, 0, 0), "value": 73.3528},
                {"date": datetime.datetime(2020, 8, 31, 0, 0), "value": 73.5951},
                {"date": datetime.datetime(2020, 9, 1, 0, 0), "value": 72.8204},
                {"date": datetime.datetime(2020, 9, 2, 0, 0), "value": 73.0126},
                {"date": datetime.datetime(2020, 9, 3, 0, 0), "value": 73.356},
                {"date": datetime.datetime(2020, 9, 8, 0, 0), "value": 73.4272},
                {"date": datetime.datetime(2020, 9, 9, 0, 0), "value": 73.6728},
                {"date": datetime.datetime(2020, 9, 10, 0, 0), "value": 73.3541},
                {"date": datetime.datetime(2020, 9, 11, 0, 0), "value": 73.4737},
                {"date": datetime.datetime(2020, 9, 14, 0, 0), "value": 73.383},
                {"date": datetime.datetime(2020, 9, 15, 0, 0), "value": 73.4169},
                {"date": datetime.datetime(2020, 9, 16, 0, 0), "value": 73.7451},
                {"date": datetime.datetime(2020, 9, 17, 0, 0), "value": 73.7021},
                {"date": datetime.datetime(2020, 9, 18, 0, 0), "value": 73.297},
                {"date": datetime.datetime(2020, 9, 21, 0, 0), "value": 73.3164},
                {"date": datetime.datetime(2020, 9, 22, 0, 0), "value": 73.4951},
                {"date": datetime.datetime(2020, 9, 23, 0, 0), "value": 73.6273},
                {"date": datetime.datetime(2020, 9, 24, 0, 0), "value": 73.9246},
                {"date": datetime.datetime(2020, 9, 25, 0, 0), "value": 73.7297},
                {"date": datetime.datetime(2020, 9, 28, 0, 0), "value": 73.5733},
                {"date": datetime.datetime(2020, 9, 29, 0, 0), "value": 73.8521},
                {"date": datetime.datetime(2020, 9, 30, 0, 0), "value": 73.7978},
                {"date": datetime.datetime(2020, 10, 1, 0, 0), "value": 73.3834},
                {
                    "date": datetime.datetime(2020, 10, 2, 0, 0),
                    "value": 74.46426322732499,
                },
                {"date": datetime.datetime(2020, 10, 5, 0, 0), "value": 73.264},
                {"date": datetime.datetime(2020, 10, 6, 0, 0), "value": 73.3684},
                {"date": datetime.datetime(2020, 10, 7, 0, 0), "value": 73.3603},
                {"date": datetime.datetime(2020, 10, 8, 0, 0), "value": 73.2943},
                {"date": datetime.datetime(2020, 10, 9, 0, 0), "value": 73.2103},
                {"date": datetime.datetime(2020, 10, 13, 0, 0), "value": 73.379},
                {"date": datetime.datetime(2020, 10, 14, 0, 0), "value": 73.4558},
                {"date": datetime.datetime(2020, 10, 15, 0, 0), "value": 73.2677},
                {"date": datetime.datetime(2020, 10, 16, 0, 0), "value": 73.383},
                {"date": datetime.datetime(2020, 10, 19, 0, 0), "value": 73.4189},
                {"date": datetime.datetime(2020, 10, 20, 0, 0), "value": 73.3337},
                {"date": datetime.datetime(2020, 10, 21, 0, 0), "value": 73.4546},
                {"date": datetime.datetime(2020, 10, 22, 0, 0), "value": 73.6557},
                {"date": datetime.datetime(2020, 10, 23, 0, 0), "value": 73.578},
                {"date": datetime.datetime(2020, 10, 26, 0, 0), "value": 73.7331},
                {"date": datetime.datetime(2020, 10, 27, 0, 0), "value": 73.7487},
                {"date": datetime.datetime(2020, 10, 28, 0, 0), "value": 73.765},
                {"date": datetime.datetime(2020, 10, 29, 0, 0), "value": 73.9732},
                {
                    "date": datetime.datetime(2020, 10, 30, 0, 0),
                    "value": 74.33190577087079,
                },
                {"date": datetime.datetime(2020, 11, 2, 0, 0), "value": 74.322},
                {"date": datetime.datetime(2020, 11, 3, 0, 0), "value": 74.326},
                {"date": datetime.datetime(2020, 11, 4, 0, 0), "value": 74.6915},
                {"date": datetime.datetime(2020, 11, 5, 0, 0), "value": 74.2677},
                {"date": datetime.datetime(2020, 11, 6, 0, 0), "value": 74.0535},
                {"date": datetime.datetime(2020, 11, 9, 0, 0), "value": 73.9258},
                {"date": datetime.datetime(2020, 11, 10, 0, 0), "value": 74.2116},
                {"date": datetime.datetime(2020, 11, 11, 0, 0), "value": 74.2529},
                {"date": datetime.datetime(2020, 11, 12, 0, 0), "value": 74.45},
                {"date": datetime.datetime(2020, 11, 13, 0, 0), "value": 74.6713},
                {
                    "date": datetime.datetime(2020, 11, 16, 0, 0),
                    "value": 74.23691115703777,
                },
                {"date": datetime.datetime(2020, 11, 17, 0, 0), "value": 74.5087},
                {"date": datetime.datetime(2020, 11, 18, 0, 0), "value": 74.3629},
                {"date": datetime.datetime(2020, 11, 19, 0, 0), "value": 74.2555},
                {"date": datetime.datetime(2020, 11, 20, 0, 0), "value": 74.1598},
                {"date": datetime.datetime(2020, 11, 23, 0, 0), "value": 74.1409},
                {"date": datetime.datetime(2020, 11, 24, 0, 0), "value": 73.9752},
                {"date": datetime.datetime(2020, 11, 25, 0, 0), "value": 73.9762},
                {
                    "date": datetime.datetime(2020, 11, 30, 0, 0),
                    "value": 74.15303422210638,
                },
                {"date": datetime.datetime(2020, 12, 1, 0, 0), "value": 73.5083},
                {"date": datetime.datetime(2020, 12, 2, 0, 0), "value": 73.6501},
                {"date": datetime.datetime(2020, 12, 3, 0, 0), "value": 73.8938},
                {"date": datetime.datetime(2020, 12, 4, 0, 0), "value": 73.7413},
                {"date": datetime.datetime(2020, 12, 7, 0, 0), "value": 73.7657},
                {"date": datetime.datetime(2020, 12, 8, 0, 0), "value": 73.7613},
                {"date": datetime.datetime(2020, 12, 9, 0, 0), "value": 73.5882},
                {"date": datetime.datetime(2020, 12, 10, 0, 0), "value": 73.6684},
                {"date": datetime.datetime(2020, 12, 11, 0, 0), "value": 73.5914},
                {"date": datetime.datetime(2020, 12, 14, 0, 0), "value": 73.5417},
                {"date": datetime.datetime(2020, 12, 15, 0, 0), "value": 73.6532},
                {"date": datetime.datetime(2020, 12, 16, 0, 0), "value": 73.5209},
                {"date": datetime.datetime(2020, 12, 17, 0, 0), "value": 73.4336},
                {"date": datetime.datetime(2020, 12, 18, 0, 0), "value": 73.5146},
                {"date": datetime.datetime(2020, 12, 21, 0, 0), "value": 73.6498},
                {"date": datetime.datetime(2020, 12, 22, 0, 0), "value": 73.8879},
                {"date": datetime.datetime(2020, 12, 23, 0, 0), "value": 73.8132},
                {"date": datetime.datetime(2021, 1, 4, 0, 0), "value": 73.0115},
                {"date": datetime.datetime(2021, 1, 5, 0, 0), "value": 73.1086},
                {"date": datetime.datetime(2021, 1, 6, 0, 0), "value": 73.139},
                {"date": datetime.datetime(2021, 1, 7, 0, 0), "value": 73.133},
                {"date": datetime.datetime(2021, 1, 8, 0, 0), "value": 73.3344},
                {"date": datetime.datetime(2021, 1, 11, 0, 0), "value": 73.4511},
                {"date": datetime.datetime(2021, 1, 12, 0, 0), "value": 73.3725},
                {"date": datetime.datetime(2021, 1, 13, 0, 0), "value": 73.1546},
                {"date": datetime.datetime(2021, 1, 14, 0, 0), "value": 73.1226},
                {"date": datetime.datetime(2021, 1, 15, 0, 0), "value": 73.0243},
                {"date": datetime.datetime(2021, 1, 19, 0, 0), "value": 73.1803},
                {"date": datetime.datetime(2021, 1, 20, 0, 0), "value": 73.1251},
                {"date": datetime.datetime(2021, 1, 21, 0, 0), "value": 72.9735},
                {"date": datetime.datetime(2021, 1, 22, 0, 0), "value": 73.038},
                {"date": datetime.datetime(2021, 1, 25, 0, 0), "value": 72.9297},
                {
                    "date": datetime.datetime(2021, 1, 26, 0, 0),
                    "value": 73.79583369571826,
                },
                {"date": datetime.datetime(2021, 1, 27, 0, 0), "value": 72.8176},
                {"date": datetime.datetime(2021, 1, 28, 0, 0), "value": 73.0674},
                {"date": datetime.datetime(2021, 1, 29, 0, 0), "value": 72.9519},
                {"date": datetime.datetime(2021, 2, 1, 0, 0), "value": 73.0189},
                {"date": datetime.datetime(2021, 2, 2, 0, 0), "value": 72.9805},
                {"date": datetime.datetime(2021, 2, 3, 0, 0), "value": 72.9396},
                {"date": datetime.datetime(2021, 2, 4, 0, 0), "value": 72.9152},
                {"date": datetime.datetime(2021, 2, 5, 0, 0), "value": 72.8986},
                {"date": datetime.datetime(2021, 2, 8, 0, 0), "value": 72.8623},
                {"date": datetime.datetime(2021, 2, 9, 0, 0), "value": 72.8883},
                {"date": datetime.datetime(2021, 2, 10, 0, 0), "value": 72.8458},
                {"date": datetime.datetime(2021, 2, 11, 0, 0), "value": 72.7772},
                {"date": datetime.datetime(2021, 2, 12, 0, 0), "value": 72.7998},
                {"date": datetime.datetime(2021, 2, 16, 0, 0), "value": 72.7219},
                {"date": datetime.datetime(2021, 2, 17, 0, 0), "value": 72.8359},
                {"date": datetime.datetime(2021, 2, 18, 0, 0), "value": 72.7327},
                {
                    "date": datetime.datetime(2021, 2, 19, 0, 0),
                    "value": 73.65705081194677,
                },
                {"date": datetime.datetime(2021, 2, 22, 0, 0), "value": 72.3664},
                {"date": datetime.datetime(2021, 2, 23, 0, 0), "value": 72.3707},
                {"date": datetime.datetime(2021, 2, 24, 0, 0), "value": 72.2923},
                {"date": datetime.datetime(2021, 2, 25, 0, 0), "value": 72.4953},
                {"date": datetime.datetime(2021, 2, 26, 0, 0), "value": 73.0408},
                {"date": datetime.datetime(2021, 3, 1, 0, 0), "value": 73.2948},
                {"date": datetime.datetime(2021, 3, 2, 0, 0), "value": 73.3507},
                {"date": datetime.datetime(2021, 3, 3, 0, 0), "value": 73.0662},
                {"date": datetime.datetime(2021, 3, 4, 0, 0), "value": 72.7126},
                {"date": datetime.datetime(2021, 3, 5, 0, 0), "value": 72.7572},
            ],
        )


if __name__ == "__main__":
    unittest.main()
